## Week 6 ARTS
------
### [A] - LC: 290. Word Pattern
------
```java
package leetcode;

import java.util.HashMap;
import java.util.Map;

/**
 * 290. Word Pattern
 *
 * Given a pattern and a string str, find if str follows the same pattern.
 *
 * Here follow means a full match, such that there is a bijection between a letter in pattern and a non-empty word in str.
 *
 * Example 1:
 *
 * Input: pattern = "abba", str = "dog cat cat dog"
 * Output: true
 * Example 2:
 *
 * Input:pattern = "abba", str = "dog cat cat fish"
 * Output: false
 * Example 3:
 *
 * Input: pattern = "aaaa", str = "dog cat cat dog"
 * Output: false
 * Example 4:
 *
 * Input: pattern = "abba", str = "dog dog dog dog"
 * Output: false
 * Notes:
 * You may assume pattern contains only lowercase letters, and str contains lowercase letters separated by a single space.
 */
public class WordPattern290 {

  public boolean wordPattern(String pattern, String str) {
    // checking length
    String[] strs = str.split(" ");
    if (pattern.length() != strs.length) return false;
    // first map checking character in pattern matching string in str
    Map<Character, String> fMap = new HashMap<>();
    // second map checking from string in str matching character in pattern
    Map<String, Character> sMap = new HashMap<>();

    for (int i = 0; i < strs.length; i++) {
      char ch = pattern.charAt(i);
      if (!fMap.containsKey(ch)) {
        fMap.put(ch, strs[i]);
      }
      if (!fMap.get(ch).equals(strs[i])) return false;
      if (!sMap.containsKey(strs[i])) {
        sMap.put(strs[i], ch);
      }
      if (sMap.get(strs[i]) != ch) return false;
    }
    return true;
  }

  public static void main(String[] args) {
    WordPattern290 test = new WordPattern290();
    System.out.println(test.wordPattern("abba", "dog cat cat dog"));
    System.out.println(test.wordPattern("abba", "dog cat cat fish"));
    System.out.println(test.wordPattern("aaaa", "dog cat cat dog"));
    System.out.println(test.wordPattern("abba", "dog dog dog dog"));
  }
}

```

### [R] - Docker Implement MySql master-slave instances on a single machine (Mac) - For local test only
------
Recently I am working on setting up MySql Store replication, first I need to set up multiple MySql instances on my local (single machine). So I reviewed some examples and using Docker for this task, simply create multiple docker containers for instances and expose MySql ports for localhost connection.

MySql master slave replication, below pic from [MySQL Master-Slave Replication on the Same Machine](https://www.toptal.com/mysql/mysql-master-slave-replication-tutorial)

![alt text](https://github.com/snowan/ARTS/blob/w5-arts/images/mysql-master-slave.png)

- Using docker compose for Master and Slave containers, example:
```yaml
version: "3.3"
services:
  mysql-master: &mysql
    image: mysql:5.7.20
    container_name: mysql-master
    restart: always
    env_file:
      - env/base.env
      - env/master.env
    environment:
      - MYSQL_ROOT_PASSWORD=root_pwd
    ports:
      - "3306:3306"
    expose:
      - "3306"
    volumes:
      - mysql-master-data:/var/lib/mysql
    command: [  # using a custom MySql configuration file
      "--log-bin=mysql-bin",
      "--server-id=1",
      "--character-set-server=utf8mb4",
      "--collation-server=utf8mb4_unicode_ci",
      "--innodb_flush_log_at_trx_commit=1",
      "--sync_binlog=1"
      ]

  mysql-slave: &mysql-slave
    <<: *mysql
    container_name: mysql-slave
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MASTER_MYSQL_ROOT_PASSWORD=root_pwd
    ports:
      - "3307:3306"
    depends_on:
      - mysql-master
    volumes:
      - mysql-slave-data:/var/lib/mysql
    command: [
      "--server-id=2", # server id must be different than master server id
      "--character-set-server=utf8mb4",
      "--collation-server=utf8mb4_unicode_ci",
      ]
 

volumes:
  mysql-master-data:
  mysql-slave-data:
```
#### [Using a custom MYSQL configuration file](https://hub.docker.com/_/mysql/)
>**Configuration without a cnf file**
Many configuration options can be passed as flags to mysqld. This will give you the flexibility to customize the container without needing a cnf file. For example, if you want to change the default encoding and collation for all tables to use UTF-8 (utf8mb4) just run the following:
>
>`$ docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci`
>
>If you would like to see a complete list of available options, just run:
>
>`$ docker run -it --rm mysql:tag --verbose --help`

- Create docker containers
`docler-compose up`

- Connection to localhost
` mysql -h localhost -P 3306 -u root --protocol=tcp -p[if set up root password]`

- Connecting to MySQL Server from within the Container
```
docker exec -it [container id] mysql -uroot -p
# Create a 
mysql> CREATE USER '[replication_user]'@'%' IDENTIFIED BY '[password]’;
# grant privilege
mysql> GRANT ALL PRIVILEGES ON * . * TO '[replication_user]'@'%’;
```
- Checking MYSQL master and slave status
```
# Start Slave
mysql> start slave;
# Checking slave status
mysql> show slave status;
```
Slave Status example output: **Slave_IO_Running** and **Slave_SQL_Running** values must be **Yes**. then master-slave set up correctly.
```
[
  {
    "Slave_IO_State": "Waiting for master to send event",
    "Master_Host": "mysql-master",
    "Master_User": "replication",
    "Master_Port": 3306,
    "Connect_Retry": 60,
    "Master_Log_File": "mysql-bin.000004",
    "Read_Master_Log_Pos": 154,
    "Relay_Log_File": "54916ce8f777-relay-bin.000007",
    "Relay_Log_Pos": 367,
    "Relay_Master_Log_File": "mysql-bin.000004",
    "Slave_IO_Running": "Yes", # Value must be YES
    "Slave_SQL_Running": "Yes", # Value must be YES
    "Replicate_Do_DB": "",
    "Replicate_Ignore_DB": "",
    "Replicate_Do_Table": "",
    "Replicate_Ignore_Table": "",
    "Replicate_Wild_Do_Table": "",
    "Replicate_Wild_Ignore_Table": "",
    "Last_Errno": 0,
    "Last_Error": "",
    "Skip_Counter": 0,
    "Exec_Master_Log_Pos": 154,
    "Relay_Log_Space": 747,
    "Until_Condition": "None",
    "Until_Log_File": "",
    "Until_Log_Pos": 0,
    "Master_SSL_Allowed": "No",
    "Master_SSL_CA_File": "",
    "Master_SSL_CA_Path": "",
    "Master_SSL_Cert": "",
    "Master_SSL_Cipher": "",
    "Master_SSL_Key": "",
    "Seconds_Behind_Master": 0,
    "Master_SSL_Verify_Server_Cert": "No",
    "Last_IO_Errno": 0,
    "Last_IO_Error": "",
    "Last_SQL_Errno": 0,
    "Last_SQL_Error": "",
    "Replicate_Ignore_Server_Ids": "",
    "Master_Server_Id": 1,
    "Master_UUID": "6cd4f3a3-a40b-11e8-a699-0242ac1c0002",
    "Master_Info_File": "/var/lib/mysql/master.info",
    "SQL_Delay": 0,
    "SQL_Remaining_Delay": null,
    "Slave_SQL_Running_State": "Slave has read all relay log; waiting for more updates",
    "Master_Retry_Count": 86400,
    "Master_Bind": "",
    "Last_IO_Error_Timestamp": "",
    "Last_SQL_Error_Timestamp": "",
    "Master_SSL_Crl": "",
    "Master_SSL_Crlpath": "",
    "Retrieved_Gtid_Set": "",
    "Executed_Gtid_Set": "",
    "Auto_Position": 0,
    "Replicate_Rewrite_DB": "",
    "Channel_Name": "",
    "Master_TLS_Version": ""
  }
]
```
**References**
1. [MySQL Master-Slave Replication on the Same Machine](https://www.toptal.com/mysql/mysql-master-slave-replication-tutorial)
2. [Docker MySql doc](https://hub.docker.com/_/mysql/)
3. [Docker MYSQL master-slave replication](https://github.com/gritt/docker-mysql-replication)

### [T] - Mac Apps & Chrome extensions recomendation
------
- [istat-menus](https://bjango.com/mac/istatmenus/)

  Powerful app to monitor Mac and fancy Dashboards:
    - CPU & GPU
    - Memory
    - Network
    - Date & Time
    - Weather
    - Battery & Power
    ...
  

- [Vimium](https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb?hl=en)

Vimium provides keyboard shortcuts for navigation and control in the spirit of Vim.

If you are vim user, it will save your ass~ :p



### [S] - [Scheduling Notebooks at Netflix](https://medium.com/netflix-techblog/scheduling-notebooks-348e6c14cfd6)
------
Take aways:
- Create different templates based on usages (e.g: data scientist, data analyst, data engineer)
- Scheduling Notebook (Run Notebook as a job)
- Each Jupyter Notebook running as a single container, and differ than execution container
- Can dynamically minimize each container


